<!doctype html>
<html lang="zh-CN">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>测试页面 — oss</title>
		<style>
			:root{font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; color-scheme: light}
			body{margin:0;padding:24px;background:#f7f7fb;color:#0b1220}
			header{display:flex;align-items:center;gap:16px}
			h1{margin:0;font-size:20px}
			main{margin-top:20px;display:grid;grid-template-columns:1fr 320px;gap:20px}
			.card{background:#fff;border-radius:8px;padding:16px;box-shadow:0 6px 18px rgba(20,24,40,0.06)}
			.controls button{margin-right:8px}
			.log{height:160px;overflow:auto;padding:8px;background:#0b12203a;border-radius:6px;font-family:monospace}
			form input, form button{padding:8px;border-radius:6px;border:1px solid #dfe6f0}
			.success{color:green}
			.error{color:#b00020}
			footer{margin-top:20px;font-size:13px;color:#6b7280}
		</style>
	</head>
	<body>
		<header>
			<img src="data:image/svg+xml;utf8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='36' height='36' viewBox='0 0 24 24'%3E%3Crect width='24' height='24' rx='5' fill='%233b82f6'/%3E%3Ctext x='50%25' y='52%25' font-size='12' font-family='Arial' text-anchor='middle' fill='white' dy='.35em'%3EOSS%3C/text%3E%3C/svg%3E" alt="logo" width="36" height="36"/>
			<h1>测试页面 — oss</h1>
		</header>

		<main>
			<section class="card">
				<h2>交互示例</h2>
				<div class="controls" style="margin-bottom:12px;">
					<button id="btn-count">点击我 (0)</button>
					<button id="btn-alert">显示提示</button>
					<button id="btn-fetch">模拟 fetch</button>
				</div>

				<div>
					<label for="name">名字（必填）</label>
					<form id="demo-form" style="display:flex;gap:8px;margin-top:8px;">
						<input id="name" name="name" placeholder="输入名字" />
						<button type="submit">提交</button>
					</form>
					<div id="form-msg" style="margin-top:8px"></div>
				</div>

				<h3 style="margin-top:16px">日志</h3>
				<div id="log" class="log" aria-live="polite"></div>
			</section>

			<aside class="card">
				<h3>自动化小测试</h3>
				<p>按下面按钮运行简单 DOM/功能断言。</p>
				<button id="run-tests">运行测试</button>
				<ul id="test-results" style="margin-top:12px;padding-left:18px"></ul>
				<footer>
					<p>打开此文件在浏览器中查看交互。<br/>创建日期：2025-11-21</p>
				</footer>
			</aside>
		</main>

		<script>
			// 小工具
			const logEl = document.getElementById('log')
			function log(...args){
				const line = document.createElement('div')
				line.textContent = args.map(a => typeof a === 'object' ? JSON.stringify(a) : String(a)).join(' ')
				logEl.prepend(line)
			}

			// 计数按钮
			const btnCount = document.getElementById('btn-count')
			let count = 0
			btnCount.addEventListener('click', ()=>{
				count++
				btnCount.textContent = `点击我 (${count})`
				log('count ->', count)
			})

			// 简单提示
			document.getElementById('btn-alert').addEventListener('click', ()=>{
				alert('这是一个测试提示')
				log('alert shown')
			})

			// 模拟 fetch（本地 mock）
			document.getElementById('btn-fetch').addEventListener('click', async ()=>{
				log('模拟网络请求中...')
				try{
					// 用 setTimeout 模拟延迟
					const res = await new Promise(r => setTimeout(()=>r({ok:true, json:()=>({time:Date.now()})}), 600))
					const data = await res.json()
					log('fetch result', data)
				}catch(e){
					log('fetch 错误', e)
				}
			})

			// 表单验证
			const form = document.getElementById('demo-form')
			const nameInput = document.getElementById('name')
			const formMsg = document.getElementById('form-msg')
			form.addEventListener('submit', e=>{
				e.preventDefault()
				const v = nameInput.value.trim()
				if(!v){
					formMsg.innerHTML = '<span class="error">名字是必填项</span>'
					log('form submit failed: empty name')
					return
				}
				formMsg.innerHTML = `<span class="success">提交成功：${escapeHtml(v)}</span>`
				log('form submitted', {name:v})
			})

			function escapeHtml(s){
				return s.replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;"})[c])
			}

			// 简易测试运行器
			document.getElementById('run-tests').addEventListener('click', ()=>{
				const results = []
				// 测试1: 初始 DOM
				results.push(assert(document.querySelector('h1')?.textContent.includes('测试页面'), '页面标题存在'))
				// 测试2: 计数按钮工作
				const before = count
				btnCount.click()
				results.push(assert(count === before+1, '计数按钮增加'))
				// 测试3: 表单验证
				nameInput.value = ''
				form.dispatchEvent(new Event('submit', {cancelable:true, bubbles:true}))
				results.push(assert(formMsg.textContent.includes('必填'), '表单必填提示'))

				renderTestResults(results)
			})

			function assert(cond, name){
				return {name, ok: Boolean(cond)}
			}

			function renderTestResults(results){
				const ul = document.getElementById('test-results')
				ul.innerHTML = ''
				results.forEach(r=>{
					const li = document.createElement('li')
					li.textContent = `${r.ok ? '✅' : '❌'} ${r.name}`
					li.style.color = r.ok ? 'green' : 'crimson'
					ul.appendChild(li)
				})
				log('tests finished', results)
			}

			// 初始日志
			log('页面已就绪', new Date().toISOString())
		</script>
	</body>
</html>
